<!doctype html>
<html>
<head>
<meta charset='UTF-8'><meta name='viewport' content='width=device-width initial-scale=1'>
<title>flask-mega-tutorial学习日记（1）</title></head>
<body><h1>Hello World</h1>
<p>&nbsp;</p>
<h3>1. 创建项目</h3>
<p>&nbsp;</p>
<p>	创建项目目录<code>flask-mega-tutorial</code></p>
<p>	使用pycharm打开项目目录，使用命令行工具创建虚拟环境</p>
<p>	<strong>注：</strong>python3.4+环境均已内部支持虚拟环境创建，执行命令为<code>py -3 -m venv venv</code>；对于python3.3-环境的均需要安装virtualenv三方库进行虚拟环境安装。</p>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554967156116.png' alt='1554967156116' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>2. 设置项目依赖环境</h3>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554968405765.png' alt='1554968405765' referrerPolicy='no-referrer' /></p>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554968461624.png' alt='1554968461624' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>3. 安装环境依赖库</h3>
<p>	设置完虚拟环境，IDE会自动加载虚拟环境，通过<code>pip install flask</code>命令安装flask三方库。</p>
<p>	若通过windows中的cmd命令行操作，可以通过<code>.\venv\Scripts\activate.bat</code>命令进入虚拟环境。</p>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554968594083.png' alt='1554968594083' referrerPolicy='no-referrer' /></p>
<p>	需要安装的库如下：</p>
<pre><code class='language-shell' lang='shell'>pip install flask
pip install flask-login
pip install flask-openid
pip install flask-mail
pip install flask-sqlalchemy
pip install sqlalchemy-migrate
pip install flask-whooshalchemy
pip install flask-wtf
pip install flask-babel
pip install guess_language
pip install flipflop
pip install coverage
</code></pre>
<h3>4. 创建项目基础目录</h3>
<p>	其中应用程序包放置在<code>app</code>目录，子文件夹 <code>static</code> 存放静态文件像图片，JS文件以及样式文件。子文件夹 <code>templates</code>是存放模板文件。</p>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554969271094.png' alt='1554969271094' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>5. 创建应用的工厂函数</h3>
<p>	修改<code>app</code>包中 <code>app/__init__.py</code>文件，编写应用的工厂函数，项目启动后会自动加载工厂函数<code>create_app</code>。flask会自动加载的工厂函数名包括：<code>create_app</code>、<code>make_app</code>。</p>
<pre><code class='language-python' lang='python'>import os
from flask import Flask


def create_app():
    &quot;&quot;&quot;应用工厂函数&quot;&quot;&quot;
    # instance_relative_config：设置配置文件以instance文件夹为相对文件夹
    # 即config.py配置文件放置在instance文件夹下。
    app = Flask(__name__, instance_relative_config=True)

    try:
        # 确保 app.instance_path 存在
        os.makedirs(app.instance_path)
    except OSError:
        pass

    return app
</code></pre>
<p>&nbsp;</p>
<h3>6. 创建应用视图代码</h3>
<p>	新建视图函数文件<code>app/hello.py</code></p>
<pre><code class='language-python' lang='python'>from flask.views import View


class HelloWorld(View):
    methods = [&#39;GET&#39;]

    def dispatch_request(self):
        return &#39;Hello World!&#39;

</code></pre>
<h3>7. 注册视图URL</h3>
<p>	修改应用工厂函数，新增视图注册</p>
<pre><code class='language-python' lang='python'>import os
from flask import Flask


def create_app():
    &quot;&quot;&quot;应用工厂函数&quot;&quot;&quot;
    # instance_relative_config：设置配置文件以instance文件夹为相对文件夹
    # 即config.py配置文件放置在instance文件夹下。
    app = Flask(__name__, instance_relative_config=True)

    # 注册hello视图URL
    from .hello import HelloWorld
    app.add_url_rule(&#39;/hello&#39;, view_func=HelloWorld.as_view(&#39;hello&#39;))

    try:
        # 确保 app.instance_path 存在
        os.makedirs(app.instance_path)
    except OSError:
        pass

    return app
</code></pre>
<h3>8. 配置pycharm启动设置</h3>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554973140807.png' alt='1554973140807' referrerPolicy='no-referrer' /></p>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554973121147.png' alt='1554973121147' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>9. 启动服务</h3>
<h4>9.1. pycharm启动服务方式</h4>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554973173010.png' alt='1554973173010' referrerPolicy='no-referrer' /></p>
<h4>9.2. cmd命令行启动服务方式</h4>
<p>	进入虚拟环境</p>
<pre><code class='language-shell' lang='shell'>.\venv\Scripts\activate.bat
</code></pre>
<p>	通过<code>flask run</code>命令启动服务</p>
<pre><code class='language-shell' lang='shell'>(venv) $ flask run
 * Environment: production
   WARNING: Do not use the development server in a production environment.
   Use a production WSGI server instead.
 * Debug mode: off
 * Running on http://127.0.0.1:5000/ (Press CTRL+C to quit)
</code></pre>
<p>&nbsp;</p>
<h3>10. 访问服务地址</h3>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554973219623.png' alt='1554973219623' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>11. 编写base模板文件</h3>
<p>	创建并编辑模板文件<code>app/templates/base.html</code></p>
<pre><code class='language-html' lang='html'>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    {% if title %}
        &lt;title&gt;{{ title }} - 博客&lt;/title&gt;
    {% else %}
        &lt;title&gt;博客&lt;/title&gt;
    {% endif %}
&lt;/head&gt;
&lt;body&gt;
    &lt;div&gt;博客：&lt;a href=&quot;{{ url_for(&#39;hello&#39;) }}&quot;&gt;首页&lt;/a&gt;&lt;/div&gt;
    &lt;hr&gt;
    {% block content %}{% endblock %}
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>&nbsp;</p>
<h3>12. 编写hello模板文件</h3>
<p>	创建并编辑模板文件<code>app/templates/hello/hello.html</code>，继承直base.html</p>
<pre><code class='language-html' lang='html'>{% extends &#39;base.html&#39; %}

{% block title %}Hello World!{% endblock %}

{% block content %}
    &lt;h1&gt;Hi, {{ user.nickname }}!&lt;/h1&gt;
    {% for post in posts %}
        &lt;div&gt;&lt;p&gt;{{ post.author.nickname }} says: &lt;b&gt;{{ post.body }}&lt;/b&gt;&lt;/p&gt;&lt;/div&gt;
    {% endfor %}
{% endblock %}

</code></pre>
<h3>13. 修改视图函数渲染模板文件</h3>
<pre><code class='language-python' lang='python'>from flask.views import View
from flask import render_template


class HelloWorld(View):
    methods = [&#39;GET&#39;]

    def dispatch_request(self):
        user = {&#39;nickname&#39;: &#39;Super.Wong&#39;}
        posts = [
            {
                &#39;author&#39;: {&#39;nickname&#39;: &#39;李白&#39;},
                &#39;body&#39;: &#39;举头望明月，低头思故乡&#39;
            },
            {
                &#39;author&#39;: {&#39;nickname&#39;: &#39;李清照&#39;},
                &#39;body&#39;: &#39;知否，知否，应是绿肥红瘦&#39;
            }
        ]
        return render_template(&#39;hello/hello.html&#39;, title=&#39;测试&#39;, user=user, posts=posts)
</code></pre>
<h3>14. 重启服务，查看结果</h3>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554977378970.png' alt='1554977378970' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>15. 创建远程git仓库，代码版本受控</h3>
<p><img src='C:\Users\wangc\AppData\Roaming\Typora\typora-user-images\1554974842785.png' alt='1554974842785' referrerPolicy='no-referrer' /></p>
<p>&nbsp;</p>
<h3>16. 初始化本地git仓库，配置远程仓库</h3>
<p>	通过<code>git init</code>命令初始化本地仓库</p>
<pre><code class='language-shell' lang='shell'>D:\Projects\learn\flask-mega-tutorial
(venv) $ git init
Initialized empty Git repository in D:/Projects/learn/flask-mega-tutorial/.git/
</code></pre>
<p>&nbsp;</p>
<p>	通过<code>git remote add</code>命令添加远程仓库</p>
<pre><code class='language-shell' lang='shell'>D:\Projects\learn\flask-mega-tutorial (master -&gt; origin)
(venv) $ git remote add origin https://gitee.com/superwong/flask-mega-tutorial.git
</code></pre>
<p>&nbsp;</p>
<p>	拉取远程仓库代码</p>
<pre><code class='language-shell' lang='shell'>D:\Projects\learn\flask-mega-tutorial (master -&gt; origin)
(venv) $ git pull origin master
From https://gitee.com/superwong/flask-mega-tutorial
 * branch            master     -&gt; FETCH_HEAD
</code></pre>
<p>&nbsp;</p>
<p>	修改.gitignore文件，增加IDE工具配置目录的版本控制忽略</p>
<pre><code># IDE
.vscode/
.idea/
</code></pre>
<p>&nbsp;</p>
<p>	通过命令<code>git add .</code>提交本地所有未提交代码</p>
<pre><code class='language-shell' lang='shell'>D:\Projects\learn\flask-mega-tutorial (master -&gt; origin)
(venv) $ git status -u
On branch master
Changes not staged for commit:
  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)
  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)

        modified:   .gitignore

Untracked files:
  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)

        app/__init__.py
        app/hello.py
        app/templates/hello.html

no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)

D:\Projects\learn\flask-mega-tutorial (master -&gt; origin)
(venv) $ git add .
</code></pre>
<p>&nbsp;</p>
<p>	通过<code>git commit</code>命令提交本地仓库</p>
<pre><code class='language-shell' lang='shell'>D:\Projects\learn\flask-mega-tutorial (master -&gt; origin)
(venv) $ git commit -m &#39;首次提交&#39;
[master 8f1d3c4] &#39;首次提交&#39;
 4 files changed, 57 insertions(+)
 create mode 100644 app/__init__.py
 create mode 100644 app/hello.py
 create mode 100644 app/templates/hello.html
</code></pre>
<p>&nbsp;</p>
<p>	通过<code>git push</code>命令推送到远程仓库</p>
<pre><code class='language-shell' lang='shell'>D:\Projects\learn\flask-mega-tutorial (master -&gt; origin)
(venv) $ git push --set-upstream origin master
Enumerating objects: 10, done.
Counting objects: 100% (10/10), done.
Delta compression using up to 4 threads
Compressing objects: 100% (7/7), done.
Writing objects: 100% (8/8), 1.43 KiB | 734.00 KiB/s, done.
Total 8 (delta 1), reused 0 (delta 0)
remote: Powered By Gitee.com
To https://gitee.com/superwong/flask-mega-tutorial.git
   d832605..8f1d3c4  master -&gt; master
Branch &#39;master&#39; set up to track remote branch &#39;master&#39; from &#39;origin&#39;.
</code></pre>
<p>&nbsp;</p>
<p>&nbsp;</p>
</body>
</html>